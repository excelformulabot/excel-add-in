<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Formula Bot</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600&display=swap" rel="stylesheet">
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css"
      integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
      crossorigin="anonymous"
    ></script>
    <script src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>
    <link
      rel="stylesheet"
      href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css"
    />
    <link href="c1abfb35c80b4a05befb.css" rel="stylesheet" />
    <script src="6b67a5f0f65f65a69213.js"></script>
    <script defer="defer" src="polyfill.js"></script>
    <script defer="defer" src="taskpane.js"></script>
    <script defer="defer" src="commands.js"></script>
    <script defer="defer" src="functions.js"></script>
    <style>
      body, button, input, textarea, select {
        font-family: 'Montserrat', sans-serif;
      }
    </style>
  </head>
  <body>
    <header class="bg-light py-1 mb-3">
      <div class="container-fluid">
        <div class="row px-0 align-items-center">
          <div class="col">
            <img
              src="https://d1muf25xaso8hp.cloudfront.net/https%3A%2F%2Fe1b5c549a6dd5273e224cd87b24dd3fb.cdn.bubble.io%2Ff1683076870037x820209632778554600%2FTransparent%2520Black.png?w=256&amp;h=51&amp;auto=compress&amp;dpr=1&amp;fit=max"
              alt="Logo"
              class="mt-1 w-100 col-auto"
            />
          </div>
          <div class="col d-flex justify-content-end">
            <button class="btn px-0" id="logout">Logout <i class="px-2 fas fa-arrow-right-from-bracket"></i></button>
          </div>
        </div>
      </div>
    </header>
    <div id="loadScr" class="bg-gray-300 fixed top-0 left-0 w-full h-full" style="display: none">
      <div class="loadHolder mt-[12rem] ml-[5.5rem]">
        <div class="loader"></div>
      </div>
    </div>
    <div class="container px-3" id="loginScr" style="display: none; padding-left: 20px; padding-right: 20px;">
      <div class="row">
        <h5 style="margin-bottom: 20px;">Translate your text instructions into formulas or input a formula to have it explained.</h5>
        <h5 style="margin-bottom: 20px;">Enrich your data with AI-powered data such as sentiment analysis, keyword extraction, text classification & more.</h5>

      </div>
      <div class="row" style="margin-top: 20px;">
  <div class="col-12">
    <h5 class="m-0 w-100">Login</h5>
  </div>
</div>
<div class="row">
  <div class="col-12">
    <div class="text-light-gray">Please enter your details</div>
  </div>
</div>
<div class="col-12" style="padding-left: 20px; padding-right: 20px;">
  <label class="mt-3 ml-4">Email:</label>
  <input placeholder="Email" id="email" class="form-control form-control-lg border-light shadow-sm" />
</div>
<div class="row" style="padding-left: 20px; padding-right: 20px;">
  <div class="col-12">
    <label class="mt-3 ml-4">Password:</label>
    <input type="password" placeholder="Password" id="password" class="form-control form-control-lg border-light shadow-sm" />
  </div>
</div>
<div class="row mt-4" style="padding-left: 20px; padding-right: 20px;">
  <div class="col-12">
    <button class="btn btn-submit btn-lg rounded-pill w-100" id="login">Login</button>
  </div>
</div>
<div class="container text-center mt-2">
  <div class="row">
    <div class="col-12 text-light-gray">Don't have an account?</div>
  </div>
  <div class="row">
    <div class="col-12">
      <a
        class="text-decoration-none fw-bolder text-purple"
        href="http://www.formulabot.com/?utm_source=excel&amp;utm_medium=addon"
        target="blank"
        >Sign up for free!</a>
    </div>
  </div>
  <div class="row mt-2">
    <div class="col-12 text-light-gray">
      Registered with Google login?
    </div>
  </div>
  <div class="row">
    <div class="col-12">
      <a
        class="text-decoration-none fw-bolder text-purple"
        href="https://app.formulabot.com/login?status=forgot-password"
        target="blank"
        >Set password here.</a>
    </div>
  </div>
  <div class="row mt-3">
    <div class="col-12">
      <span class="text-light-gray">Experiencing issues? Contact </span>
      <a class="text-decoration-none fw-bolder text-black" href="mailto:hello@formulabot.com">hello@formulabot.com</a>
    </div>
  </div>
</div>
</div>

<main>
  <div class="container-fluid h-100" id="mainScr" style="display: none">
    <div class="container d-flex justify-content-between align-items-center py-1">
      <button class="btn btn-lg px-2" id="back-button" style="display: none">
        <i class="fas fa-arrow-left"></i>
      </button>
      <h5 class="m-0 w-100 text-green" id="header-label">I want to...</h5>
    </div>
    <div class="row h-100">

          
         <!-- BEGIN GENERATE SECTION -->
<div class="btn-section-content d-none" id="generate-formula-section" style="margin-bottom: 20px;">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <small>Input your text instructions here to generate a formula</small>
        <textarea
          type="text"
          class="form-control form-control-lg"
          id="txtGenerateInput"
          rows="6"
          placeholder="Input your request here."
        ></textarea>
      </div>
    </div>
    <div class="row py-3">
      <div class="col-12">
        <button type="button" class="btn btn-submit btn-lg rounded-pill w-100" id="btnSubmitGenerate">
          Submit
        </button>
      </div>
    </div>
    <div class="row">
      <div class="col-12">
        <small>Results</small>
        <textarea
          type="text"
          class="form-control form-control-lg mb-3 mb-md-0"
          id="txtGenerateOutput"
          rows="3"
          placeholder="The formula will show here"
        ></textarea>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-5">
        <button type="button" class="btn rounded-pill border w-100" id="btnCopyGenerate">Copy</button>
      </div>
      <div class="col-7">
        <button type="button" class="btn rounded-pill border w-100" id="btnInsertGenerate">
          Insert in cell
        </button>
      </div>
    </div>
  </div>
</div>

          <!-- END GENERATE SECTION -->

          <!-- BEGIN EXPLAIN SECTION -->
          <div class="btn-section-content d-none" id="explain-formula-section">
            <div class="container">
              <div class="row">
                <div class="col-12">
                  <textarea
                    type="text"
                    class="form-control form-control-lg"
                    id="txtExplainInput"
                    rows="3"
                    placeholder="Input your formula here to have it explained"
                  ></textarea>
                </div>
              </div>
              <div class="row py-3">
                <div class="col-12">
                  <button type="button" class="btn btn-submit btn-lg rounded-pill w-100" id="btnSubmitExplain">
                    Submit
                  </button>
                </div>
              </div>
              <div class="row">
                <div class="col-12">
                  <textarea
                    type="text"
                    class="form-control form-control-lg mb-3 mb-md-0"
                    id="txtExplainOutput"
                    rows="3"
                    placeholder="Explanation will show here"
                  ></textarea>
                </div>
              </div>
              <div class="row mt-3">
                <div class="col-5">
                  <button type="button" class="btn rounded-pill border w-100" id="btnCopyExplain">Copy</button>
                </div>
                <div class="col-7">
                  <button type="button" class="btn rounded-pill border w-100" id="btnInsertExplain">
                    Insert in cell
                  </button>
                </div>
              </div>
            </div>
          </div>
          <!-- EXPLAIN EXPLAIN SECTION -->

          <!-- BEGIN CLASSIFY SECTION -->
          <div class="btn-section-content d-none" id="classify-section">
            <div class="container">
              <div class="row">
                <div class="col-12">
                  <div class="text-center fs-5">Classify</div>
                </div>
              </div>
              <div class="row">
                <div class="col-12">
                  <input
                    class="form-control form-control-lg border-light shadow-sm"
                    id="txtClassifyType"
                    placeholder="Company"
                  />
                </div>
              </div>
              <div class="row text-center mt-4 py-1">
                <div class="col-12">
                  <div class="text-center fs-5">in cell</div>
                </div>
              </div>
              <div class="row text-center py-1">
                <div class="col-12">
                  <div class="input-group input-group-append rounded shadow-sm">
                    <input
                      class="form-control form-control-lg border-light"
                      id="txtClassifyRange"
                      placeholder="Ex: B2"
                    /><button type="button" class="btn btn-light get-active-range">
                      Copy selected<i class="ps-2 fa-sharp fa-solid fa-copy"></i>
                    </button>
                  </div>
                </div>
              </div>
              <div class="row text-center mt-4 py-1">
                <div class="col-12">
                  <div class="text-center fs-5">based on</div>
                </div>
              </div>
              <div class="row text-center py-1">
                <div class="col-12">
                  <input
                    class="form-control form-control-lg border-light shadow-sm"
                    id="txtClassifyBasedOn"
                    placeholder="industry"
                  />
                </div>
              </div>
              <div class="row text-center mt-4 py-1">
                <div class="col-12">
                  <div class="text-center fs-5">into one of the following groups</div>
                </div>
              </div>
              <div id="txtClassifyCategories">
                <div class="row py-1">
                  <div class="col-sm-12 col-md">
                    <div class="input-group input-group-append rounded shadow-sm">
                      <input class="form-control form-control-lg border-light" placeholder="Group A" /><button
                        type="button"
                        class="btn btn-light delete-field"
                      >
                        <i class="fas fa-trash"></i>
                      </button>
                    </div>
                  </div>
                </div>
                <div class="row py-1">
                  <div class="col-sm-12 col-md">
                    <div class="input-group input-group-append rounded shadow-sm">
                      <input class="form-control form-control-lg border-light" placeholder="Group B" /><button
                        type="button"
                        class="btn btn-light delete-field"
                      >
                        <i class="fas fa-trash"></i>
                      </button>
                    </div>
                  </div>
                </div>
                <div class="row py-1">
                  <div class="col-12">
                    <a class="text-center text-decoration-none text-purple fw-bolder small" href="#" id="add-field"
                      >(+) Add</a
                    >
                  </div>
                </div>
              </div>
              <div class="row mt-4">
                <div class="col-12">
                  <button type="button" class="btn btn-submit btn-lg rounded-pill w-100" id="btnInsertClassify">
                    Insert in cell
                  </button>
                </div>
                <div class="my-4 text-center">
                   <!-- PASTE VALUES -->
              <div id="paste-widget">
                <div class="row py-1">
                    <div class="col">
                        <button type="button" class="btn btn-home-paste btn-lg rounded-pill w-100" id="btnPasteValues">
                          <div class="fw-bolder section-label">Paste as static values</div>
                        </button>
                    </div>
                </div>
                <div class="row py-1 mt-2">
                    <div class="section-sublabel">
                      <div class="row gx-0 align-items-center">
                        <div class="col-1 text-end">
                          <i class="pe-3 fas fa-circle-info"></i>
                        </div>
                        <div class="col-11">
                          This prevents new results from generating when the page is refreshed. Limited only to this sheet!
                        </div>
                      </div>
                    </div>
                </div>
              </div>
            </div>
          </div>
              </div>
          </div>
          <!-- END CLASSIFY SECTION -->

          <!-- BEGIN EXTRACT SECTION -->
          <div class="btn-section-content d-none" id="extract-section">
            <div class="container">
              <div class="row">
                <div class="col-12">
                  <div class="text-center fs-5">Extract the</div>
                </div>
              </div>
              <div class="row">
                <div class="col-12">
                  <input
                    class="form-control form-control-lg border-light shadow-sm cell-range"
                    id="txtExtractDescription"
                    placeholder="company name"
                  />
                </div>
              </div>
              <div class="row text-center mt-4 py-1">
                <div class="col-12">
                  <div class="text-center fs-5">from</div>
                </div>
              </div>
              <div class="row">
                <div class="col-12">
                  <div class="input-group input-group-append rounded shadow-sm">
                    <input
                      class="form-control form-control-lg border-light bg-gradient"
                      id="txtExtractRange"
                      placeholder="Ex: B2"
                    /><button type="button" class="btn btn-light get-active-range">
                      Copy selected<i class="ps-2 fa-sharp fa-solid fa-copy"></i>
                    </button>
                  </div>
                </div>
              </div>
              <div class="row mt-4">
                <div class="col-12">
                  <button type="button" class="btn btn-submit btn-lg rounded-pill w-100" id="btnInsertExtract">
                    Insert in cell
                  </button>
                </div>
                <div class="my-4 text-center">
                  <!-- PASTE VALUES -->
              <div id="paste-widget">
                <div class="row py-1">
                    <div class="col">
                        <button type="button" class="btn btn-home-paste btn-lg rounded-pill w-100" id="btnPasteValues">
                          <div class="fw-bolder section-label">Paste as static values</div>
                        </button>
                    </div>
                </div>
                <div class="row py-1 mt-2">
                    <div class="section-sublabel">
                      <div class="row gx-0 align-items-center">
                        <div class="col-1 text-end">
                          <i class="pe-3 fas fa-circle-info"></i>
                        </div>
                        <div class="col-11">
                          This prevents new results from generating when the page is refreshed. Limited only to this sheet!
                        </div>
                      </div>
                    </div>
                </div>
              </div>
            </div>
          </div>
              </div>
          </div>
          <!-- END EXTRACT SECTION -->

          <!-- BEGIN SENTIMENT SECTION -->
          <div class="btn-section-content d-none" id="analyze-sentiment-section">
            <div class="container">
              <div class="row">
                <div class="col-12">
                  <div class="text-center fs-5">Analyze sentiment of</div>
                </div>
              </div>
              <div class="row">
                <div class="col-12">
                  <div class="input-group input-group-append rounded shadow-sm">
                    <input
                      class="form-control form-control-lg border-light bg-gradient"
                      id="txtSentimentRange"
                      placeholder="Ex: B2"
                    /><button type="button" class="btn btn-light get-active-range">
                      Copy selected<i class="ps-2 fa-sharp fa-solid fa-copy"></i>
                    </button>
                  </div>
                </div>
              </div>
              <div class="row text-center mt-4 py-1">
                <div class="col-12">
                  <div class="text-center fs-5">as one of the following</div>
                </div>
              </div>
              <div id="txtSentimentCategories">
                <div class="row py-1">
                  <div class="col-sm-12 col-md">
                    <div class="input-group input-group-append rounded shadow-sm">
                      <input class="form-control form-control-lg border-light" placeholder="Positive" /><button
                        type="button"
                        class="btn btn-light delete-field"
                      >
                        <i class="fas fa-trash"></i>
                      </button>
                    </div>
                  </div>
                </div>
                <div class="row py-1">
                  <div class="col-sm-12 col-md">
                    <div class="input-group input-group-append rounded shadow-sm">
                      <input class="form-control form-control-lg border-light" placeholder="Negative" /><button
                        type="button"
                        class="btn btn-light delete-field"
                      >
                        <i class="fas fa-trash"></i>
                      </button>
                    </div>
                  </div>
                </div>
                <div class="row py-1">
                  <div class="col-sm-12 col-md">
                    <div class="input-group input-group-append rounded shadow-sm">
                      <input class="form-control form-control-lg border-light" placeholder="Neutral" /><button
                        type="button"
                        class="btn btn-light delete-field"
                      >
                        <i class="fas fa-trash"></i>
                      </button>
                    </div>
                  </div>
                </div>
                <div class="row py-1">
                  <div class="col-12">
                    <a class="text-center text-decoration-none text-purple fw-bolder small" href="#" id="add-field"
                      >(+) Add</a
                    >
                  </div>
                </div>
              </div>
              <div class="row mt-4">
                <div class="col-12">
                  <button type="button" class="btn btn-submit btn-lg rounded-pill w-100" id="btnInsertSentiment">
                    Insert in cell
                  </button>
                </div>
                <div class="my-4 text-center">
                  <!-- PASTE VALUES -->
              <div id="paste-widget">
                <div class="row py-1">
                    <div class="col">
                        <button type="button" class="btn btn-home-paste btn-lg rounded-pill w-100" id="btnPasteValues">
                          <div class="fw-bolder section-label">Paste as static values</div>
                        </button>
                    </div>
                </div>
                <div class="row py-1 mt-2">
                    <div class="section-sublabel">
                      <div class="row gx-0 align-items-center">
                        <div class="col-1 text-end">
                          <i class="pe-3 fas fa-circle-info"></i>
                        </div>
                        <div class="col-11">
                          This prevents new results from generating when the page is refreshed. Limited only to this sheet!
                        </div>
                      </div>
                    </div>
                </div>
              </div>
            </div>
          </div>               
        
              </div>
          </div>
          <!-- END SENTIMENT SECTION -->

          <!-- BEGIN RETRIEVE SECTION -->
          <div class="btn-section-content d-none" id="retrieve-info-section">
            <div class="container">
              <div class="row">
                <div class="col-12">
                  <div class="text-center fs-5">Give me the</div>
                </div>
              </div>
              <div class="row">
                <div class="col-12">
                  <input
                    class="form-control form-control-lg border-light shadow-sm"
                    id="txtRetrieveDescription"
                    placeholder="Population"
                  />
                </div>
              </div>
              <div class="row text-center mt-4 py-1">
                <div class="col-12">
                  <div class="text-center fs-5">of</div>
                </div>
              </div>
              <div class="row">
                <div class="col-12">
                  <div class="input-group input-group-append rounded shadow-sm">
                    <input
                      class="form-control form-control-lg border-light bg-gradient"
                      id="txtRetrieveRange"
                      placeholder="Ex: B2"
                    /><button type="button" class="btn btn-light get-active-range">
                      Copy selected<i class="ps-2 fa-sharp fa-solid fa-copy"></i>
                    </button>
                  </div>
                </div>
              </div>
              <div class="row mt-4">
                <div class="col-12">
                  <button type="button" class="btn btn-submit btn-lg rounded-pill w-100" id="btnInsertRetrieve">
                    Insert in cell
                  </button>
                </div>
                <div class="my-4 text-center">
                  <!-- PASTE VALUES -->
              <div id="paste-widget">
                <div class="row py-1">
                    <div class="col">
                        <button type="button" class="btn btn-home-paste btn-lg rounded-pill w-100" id="btnPasteValues">
                          <div class="fw-bolder section-label">Paste as static values</div>
                        </button>
                    </div>
                </div>
                <div class="row py-1 mt-2">
                    <div class="section-sublabel">
                      <div class="row gx-0 align-items-center">
                        <div class="col-1 text-end">
                          <i class="pe-3 fas fa-circle-info"></i>
                        </div>
                        <div class="col-11">
                          This prevents new results from generating when the page is refreshed. Limited only to this sheet!
                        </div>
                      </div>
                    </div>
                </div>
              </div>
            </div>
          </div>
              </div>
          </div>
          <!-- END RETRIEVE SECTION -->

          <!-- BEGIN FREEFORM SECTION -->
          <div class="btn-section-content d-none" id="freeform-section">
            <div class="container">
              <div class="row">
                <div class="col-12">
                  <div>
                    The <span class="fw-bolder">=FORMULABOT.FREEFORM</span> formula lets you type in anything, allowing
                    you to fully customize the response.<br /><br />Make sure to be as specific as possible. If you do
                    not get the desired results, try again.
                  </div>
                </div>
              </div>
              <div class="row fs-5 text-purple">
                <div class="col-12">=FORMULABOT.FREEFORM</div>
              </div>
              <div class="row mt-3">
                <div class="col-12">
                  <div class="fw-bolder">Examples:</div>
                </div>
              </div>
              <div class="row">
                <div class="col-12">
                  <div>
                    =FORMULABOT.FREEFORM(<span class="text-green">"Write me a thank you note to ",</span><span class="text-orange">B10</span><span class="text-green">,"for gifting me a",</span><span class="text-orange">C10</span>)
                </div>
              </div>
          </div>
              <div class="row mt-2">
                <div class="col-12">
                  <div>=FORMULABOT.FREEFORM(<span class="text-green">"Write me an article about SEO"</span>)</div>
               </div>
              </div>
              <!-- PASTE VALUES -->
              <div id="paste-widget">
                <div class="row py-1">
                    <div class="col">
                        <button type="button" class="btn btn-home-paste btn-lg rounded-pill w-100" id="btnPasteValues">
                          <div class="fw-bolder section-label">Paste as static values</div>
                        </button>
                    </div>
                </div>
                <div class="row py-1 mt-2">
                    <div class="section-sublabel">
                      <div class="row gx-0 align-items-center">
                        <div class="col-1 text-end">
                          <i class="pe-3 fas fa-circle-info"></i>
                        </div>
                        <div class="col-11">
                          This prevents new results from generating when the page is refreshed. Limited only to this sheet!
                        </div>
                      </div>
                    </div>
                </div>
              </div>
            </div>
          </div>
          <!-- END FREEFORM SECTION -->

          <!-- BEGIN INFER SECTION -->
          <div class="btn-section-content d-none" id="infer-section">
            <div class="container">
              <div class="row">
                <div class="col-12">
                  <div>
                    The <span class="fw-bolder">=FORMULABOT.INFER</span> formula allows you to insert examples of inputs
                    and outputs to infer additional inputs in which you don't have an output.
                  </div>
                </div>
              </div>
              <div class="row fs-5 text-purple">
                <div class="col-12">=FORMULABOT.INFER</div>
              </div>
              <div class="row mt-3">
                <div class="col-12">
                  <div class="fw-bolder">Examples:</div>
                </div>
              </div>
              <div class="row">
                <div class="col-12">
                  <img
                    src="https://e1b5c549a6dd5273e224cd87b24dd3fb.cdn.bubble.io/f1683555077821x914146478826124900/infer.png"
                    alt="Logo"
                    class="mt-1 img-fluid"
                  />
                </div>
              </div>
              <!-- PASTE VALUES -->
              <div id="paste-widget">
                <div class="row py-1">
                    <div class="col">
                        <button type="button" class="btn btn-home-paste btn-lg rounded-pill w-100" id="btnPasteValues">
                          <div class="fw-bolder section-label">Paste as static values</div>
                        </button>
                    </div>
                </div>
                <div class="row py-1 mt-2">
                    <div class="section-sublabel">
                      <div class="row gx-0 align-items-center">
                        <div class="col-1 text-end">
                          <i class="pe-3 fas fa-circle-info"></i>
                        </div>
                        <div class="col-11">
                          This prevents new results from generating when the page is refreshed. Limited only to this sheet!
                        </div>
                      </div>
                    </div>
                </div>
              </div>
            </div>
          </div>
          <!-- END INFER SECTION -->

        </div>
      </div>
      <div class="container" id="home-section">
        <div class="row py-1">
          <div class="col">
            <div class="card px-0" id="generate-formula-button">
              <div class="card-body">
                <h5 class="card-title"><i class="pe-2 fas fa-divide"></i>Generate Formula</h5>
                <p class="card-text">Generate a formula based on text instructions</p>
              </div>
            </div>
          </div>
        </div>
        <div class="row py-1">
          <div class="col">
            <div class="card px-0" id="explain-formula-button">
              <div class="card-body">
                <h5 class="card-title"><i class="pe-2 fa-regular fa-message"></i>Explain Formula</h5>
                <p class="card-text">Input a formula to have it explained for you</p>
              </div>
            </div>
          </div>
        </div>
        <div class="container border-top border-bottom border-light grid-container list-view px-0 mt-3 pt-3">
          <div class="d-flex align-items-center">
            <h5 class="float-none me-auto text-purple">Enrichments</h5>
            <button class="btn btn-list px-1 text-purple"><i class="fas fa-list view-type"></i></button
            ><button class="btn btn-grid px-1"><i class="fas fa-grip-vertical view-type"></i></button>
          </div>
          <div>
            <p style="font-size: 12px" id="requests_remaining">
              <!-- where the requests remaining will go -->
            </p>
          </div>
          <div class="row gx-1">
            <div class="col-12 card-col">
              <div class="card px-0" id="analyze-sentiment-button">
                <div class="card-body">
                  <h5 class="card-title"><i class="pe-2 fa-regular fa-heart"></i>Analyze Sentiment</h5>
                  <p class="card-text">Determine the sentiment of text, like if it's positive or negative</p>
                </div>
              </div>
            </div>
            <div class="col-12 card-col">
              <div class="card px-0" id="retrieve-info-button">
                <div class="card-body">
                  <h5 class="card-title"><i class="pe-2 fa-solid fa-magnifying-glass"></i>Retrieve Information</h5>
                  <p class="card-text">Populate information about anything (i.e. a state's capital)</p>
                </div>
              </div>
            </div>
            <div class="col-12 card-col">
              <div class="card px-0" id="classify-button">
                <div class="card-body">
                  <h5 class="card-title"><i class="pe-2 fa-solid fa-sitemap"></i>Classify</h5>
                  <p class="card-text">Classify information into multiple categories</p>
                </div>
              </div>
            </div>
            <div class="col-12 card-col">
              <div class="card px-0" id="extract-button">
                <div class="card-body">
                  <h5 class="card-title"><i class="pe-2 fas fa-object-ungroup"></i>Extract</h5>
                  <p class="card-text">Pull out specific information from a text</p>
                </div>
              </div>
            </div>
            <div class="col-12 card-col">
              <div class="card px-0" id="freeform-button">
                <div class="card-body">
                  <h5 class="card-title"><i class="pe-2 fa-solid fa-paragraph"></i>Freeform</h5>
                  <p class="card-text">It's ChatGPT inside your spreadsheet!</p>
                </div>
              </div>
            </div>
            <div class="col-12 card-col">
              <div class="card px-0" id="infer-button">
                <div class="card-body">
                  <h5 class="card-title"><i class="pe-2 fas fa-wand-magic-sparkles"></i>Infer</h5>
                  <p class="card-text">Provide examples of data to infer an output for select inputs</p>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div id="paste-widget">
          <div class="row py-1">
            <div class="col">
              <button type="button" class="btn btn-home-paste btn-lg rounded-pill w-100" id="btnPasteValues">
                <div class="fw-bolder section-label">Paste as static values</div>
              </button>
            </div>
          </div>
          <div class="row py-1 mt-2">
            <div class="section-sublabel">
              <div class="row gx-0 align-items-center">
                <div class="col-1 text-end"><i class="pe-3 fas fa-circle-info"></i></div>
                <div class="col-11">
                  This prevents new results from generating when the page is refreshed. Limited only to this sheet!
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
    <div
      class="modal fade"
      id="modalSpinningWheel"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header"></div>
          <div class="modal-body text-center">
            <div class="d-flex justify-content-center">
              <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
              </div>
            </div>
            <div>Please wait while we process your request...</div>
            <div class="small fst-italic text-secondary">
              (Don't click buttons or try to close this as it could interupt the request.)
            </div>
          </div>
        </div>
      </div>
    </div>
    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      var section_labels = {
        "generate-formula-section": "Generate Formula",
        "explain-formula-section": "Explain Formula",
        "classify-section": "Classify",
        "extract-section": "Extract",
        "analyze-sentiment-section": "Analyze Sentiment",
        "retrieve-info-section": "Retrieve Info",
        "freeform-section": "Freeform",
        "infer-section": "Infer",
      };

      function updateBtn(t, e, n) {
        console.log("selector", t, "msg", e, "org", n),
          $(t).text(e),
          setTimeout(() => {
            $(t).text(n);
          }, 3e3);
      }
      async function isLoggedIn() {
        return (
          (activeState = localStorage.getItem("token")),
          console.log("activeState", activeState),
          activeState
            ? ($("#logout").show(),
              $("#loginScr").hide(),
              $("#mainScr").show(),
              $("#home-section").show(),
              $("#header-label").show(),
              void $("#loadScr").hide())
            : ($("#logout").hide(),
              $("#loginScr").show(),
              $("#mainScr").hide(),
              $("#home-section").hide(),
              $("#header-label").hide(),
              void $("#loadScr").hide())
        );
      }

      function delay(t) {
        return new Promise((e) => setTimeout(e, 1e3 * t));
      }

      function copyFunc() {
        var t = document.querySelector("#output");
        navigator.clipboard.writeText(t.value), updateBtn("#copy", "Copied!", "Copy");
      }

      function updateBtn(t, e, n) {
        var o = document.querySelector(t);
        (o.innerText = e),
          setTimeout(() => {
            o.innerText = n;
          }, 2e3);
      }

      function insertCellClientSide(t) {
        try {
          Excel.run(function (e) {
            let n = e.workbook.getSelectedRange();
            return (
              n.load("address"),
              e.sync().then(function () {
                return (n.values = [[t]]), e.sync();
              })
            );
          });
        } catch (t) {
          console.error(t);
        }
      }
      async function callAPI(t, e) {
        var n = localStorage.getItem("token");
        console.log(n);
        try {
          const i = "https://app.formulabot.com/api/1.1/wf/" + t,
            l = {
              method: "POST",
              headers: {
                Authorization: `Bearer ${n}`,
                "Content-Type": "application/json",
              },
              body: JSON.stringify(e),
            };
          console.log("CALL API OPTIONS", i, l);
          var o = await fetch(i, l);
          console.log(o);
          var a = await o.json();
          return console.log("CALL API RESP", a), a?.response?.output ?? "Request failed, try again. If issue persists, log out and try again or contact hello@formulabot.com.";
        } catch (t) {
          return "Request failed, try again. If issue persists, log out and try again or contact hello@formulabot.com. " + t;
        }
      }
      Office.onReady(async (t) => {
        t.host === Office.HostType.Excel &&
          (await isLoggedIn(),
          console.log('ran isLoggedin'),
          $("body").on("click", ".btn-grid", async function (t) {
            var e = $(".grid-container");
            t.preventDefault(),
              e.removeClass("list-view"),
              e.find(".card-text").addClass("d-none"),
              e.find(".card-title").addClass("small"),
              e.find(".card-col").removeClass("col-12").addClass("col-6"),
              $(".btn-grid").addClass("text-purple"),
              $(".btn-list").removeClass("text-purple");
          }),
          $("body").on("click", ".btn-list", async function (t) {
            var e = $(".grid-container");
            t.preventDefault(),
              e.hasClass("list-view") ? e.removeClass("list-view") : e.addClass("list-view"),
              e.find(".card-text").removeClass("d-none"),
              e.find(".card-title").removeClass("small"),
              e.find(".card-col").removeClass("col-6").addClass("col-12"),
              $(".btn-list").addClass("text-purple"),
              $(".btn-grid").removeClass("text-purple");
          }),
          $("body").on("click", ".card", async function (t) {
            const e = $(".btn-section-content");
            console.log(e), e.addClass("d-none"), $("#home-section").addClass("d-none");
            const n = $(this).attr("id").replace("button", "section"),
              o = $("#" + n);
            console.log("sectionId", t.target.id, "activeSection", o),
              o.removeClass("d-none"),
              console.log("sectionId", n, "Header", section_labels[n]),
              $("#header-label").text(section_labels[n]).removeClass("text-green").addClass("text-center"),
              window.scrollTo(0, 0),
              $("#back-button").show();
          }));
      }),
        $("body").on("click", "#back-button", async function (t) {
          $('div[id$="section"]').addClass("d-none"),
            $("#header-label").text("I want to..."),
            $("#home-section").removeClass("d-none"),
            $("#back-button").hide();
        }),
        $(document).on("click", ".get-active-range", async function () {
          const t = await getActiveRange();
          var e = $(this).closest(".input-group").find("input");
          $(e).val(t);
        }),
        $("body").on("click", "#add-field", function (t) {
          $(
            '\n          <div class="row py-1">\n            <div class="col-sm-12 col-md">\n              <div class="input-group input-group-append rounded shadow-sm">\n                <input type="text" class="form-control form-control-lg border-light" value="New category">\n                <button type="button" class="btn btn-light delete-field">\n                  <i class="fas fa-trash"></i>\n                </button>\n              </div>\n            </div>\n          </div>\n        '
          ).insertBefore($(this).closest(".row"));
        }),
        $(document).on("click", ".delete-field", function () {
          $(this).closest(".row").remove();
        }),
        $(document).on("click", "#btnInsertGenerate", async function () {
          const t = $("#txtGenerateOutput").val();
          await insertCellClientSide(t);
        }),
        $(document).on("click", "#btnInsertExplain", async function () {
          const t = $("#txtExplainOutput").val();
          console.log("output", t), await insertCellClientSide(t);
        }),
        $(document).on("click", "#btnInsertClassify", async function () {
          const t = $("#txtClassifyType").val(),
            e = $("#txtClassifyRange").val(),
            n = $("#txtClassifyBasedOn").val();
          var o = [];
          $("#txtClassifyCategories input").each(function () {
            "" != $(this).val() && o.push($(this).val().toString());
          });
          const a = `=FORMULABOT.CLASSIFY("${t}", ${e}, "${n}", "${(o = o.filter((t) => "" != t).join('","'))}")`;
          await insertCellClientSide(a);
        }),
        $(document).on("click", "#btnInsertExtract", async function () {
          const t = `=FORMULABOT.EXTRACT(${$("#txtExtractRange").val()},"${$("#txtExtractDescription").val()}")`;
          await insertCellClientSide(t);
        }),
        $(document).on("click", "#btnInsertSentiment", async function () {
          const t = $("#txtSentimentRange").val();
          var e = [];
          $("#txtSentimentCategories input").each(function () {
            e.push($(this).val());
          }),
            console.log("categories", e);
          const n = `=FORMULABOT.SENTIMENT(${t},"${(e = e.filter((t) => "" != t).join('","'))}")`;
          await insertCellClientSide(n);
        }),
        $(document).on("click", "#btnInsertRetrieve", async function () {
          const t = `=FORMULABOT.INFO(${$("#txtRetrieveRange").val()},"${$("#txtRetrieveDescription").val()}")`;
          await insertCellClientSide(t);
        }),
        $(document).on("click", "#btnSubmitGenerate", async function () {
          try {
            var t = $("#txtGenerateInput").val();
            $("#modalSpinningWheel").modal("show");
            const e = {
                input: t.toString(),
                platform: "Excel Sheets Add-in",
                outputType: "Formula",
              },
              n = await callAPI("output", e);
            console.log("btnSubmitGenerate result", n),
              $("#txtGenerateOutput").val(n),
              $("#modalSpinningWheel").modal("hide");
          } catch (t) {
            console.error(t);
          }
        }),
        $(document).on("click", "#btnSubmitExplain", async function () {
          try {
            var t = $("#txtExplainInput").val();
            $("#modalSpinningWheel").modal("show");
            const e = {
                input: t.toString(),
                platform: "Excel Add-in",
                outputType: "Explain",
              },
              n = await callAPI("output", e);
            console.log("btnSubmitExplain result", n),
              $("#txtExplainOutput").val(n),
              $("#modalSpinningWheel").modal("hide");
          } catch (t) {
            console.error(t);
          }
        }),
        $(document).on("click", "#btnPasteValues", async function () {
          $("#modalSpinningWheel").modal("show");
          try {
            var t = await replaceFormulasWithValues();
            console.log("count", t), await delay(0.5), $("#modalSpinningWheel").modal("hide");
          } catch (t) {
            console.error(t), $("#modalSpinningWheel").modal("hide");
          }
        }),
        $(document).on("click", "#btnCopyGenerate, #btnCopyExplain", async function () {
          var t =
            "btnCopyGenerate" == $(this).attr("id") ? $("#txtGenerateOutput").val() : $("#txtExplainOutput").val();
          console.log("output", t, "#" + $(this).attr("id")),
            navigator.clipboard.writeText(t),
            updateBtn("#" + $(this).attr("id"), "Copied!", "Copy");
        }),
        $(document).on("click", "#login", async function () {
          var t = document.querySelector("#email").value,
            e = document.querySelector("#password").value;
          if (-1 != t.indexOf("@") && "" != e) {
            $("#login").text("Logging In...");
            try {
              const a = "https://app.formulabot.com/api/1.1/wf/login/",
                i = {
                  email: t,
                  password: e,
                };
              console.log("payload", i);
              const l = {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify(i),
              };
              console.log("CALL LOGIN OPTIONS", a, l);
              var n = await fetch(a, l);
              console.log(n);
              var o = await n.json();
              return (
                console.log("CALL LOGIN RESP", o),
                "success" == o.status
                  ? (localStorage.setItem("token", o.response.token),
                    console.log("res.status", o.status),
                    localStorage.setItem("requests", o.response.requests_remaining),  
                    document.querySelector("#requests_remaining").innerText = o.response.requests_remaining,  
                    1 == o.response.subscription
                      ? ($("#logout").show(),
                        $("#login").text("Login"),
                        $("#email").val(""),
                        $("#password").val(""),
                        $("#loginScr").hide(),
                        $("#mainScr").show(),
                        $("#home-section").show(),
                        $("#header-label").show(),
                        $("#loadScr").hide())
                      : ($("#header-label").hide(),
                        $("#logout").hide(),
                        $("#loginScr").show(),
                        $("#mainScr").hide(),
                        $("#loadScr").hide(),
                        updateBtn("#login", "Invalid Email/Password", "Login")))
                  : updateBtn("#login", res.message, "Login"),
                "INVALID_LOGIN_CREDENTIALS" === o.reason
                  ? void updateBtn("#login", "Invalid Email/Password", "Login")
                  : o?.response?.output ?? "Please log out and log back in. If issue persists, please contact hello@formulabot.com."
              );
            } catch (t) {
              updateBtn("#login", "Invalid Email/Password", "Login")
              return "Please log out and log back in. If issue persists, please contact hello@formulabot.com." + t;
            }
          } else updateBtn("#login", "Fill Input Field!", "Login");
        }),
        $(document).on("click", "#logout", async function () {
          (console.log('logout hidden'),
            localStorage.removeItem("token"),
            $("#logout").hide(),
            $("#loginScr").show(),
            $("#mainScr").hide(),
            $("#loadScr").hide(),
            $("#input").val(""),
            $("#output").val(""),
            $("#home-section").hide(),
            $("#header-label").hide())
        });
    </script>
  </body>
</html>
